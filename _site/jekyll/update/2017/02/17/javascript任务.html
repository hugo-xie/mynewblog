<!DOCTYPE html>
<html>
<head>
  <title>javascript中的task和microtask!</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <meta name="applicable-device"content="pc,mobile"/>
  <link rel="stylesheet" href="/images/new.css">
  <style type="text/css">
  a{
    color: rgb(181,181,181);
    text-decoration: none;
    margin-left: 50px;
    display: inline-block;
  }
  a:hover{
    color: rgb(44,60,73);
  }
  h1{
    color: rgb(181,181,181);
  }
  </style>
</head>
<body style="padding: 0px;margin: 0px;">
<div style="width: 100%;background-color: rgb(44,60,73);color:white;line-height: 50px; ">
   <a href="/" style="color: white">Hugo的个人网站</a>
</div>
<div style="width: 100%;line-height:40px;background-color: rgb(236,236,236);">
  <a href="/">Home</a>
  <a href="https://github.com/hugo-xie">Github</a>
  <a href="https://github.com/hugo-xie">ZhiHu</a>
  <a href="https://github.com/hugo-xie">DouBan</a>
  <a href="https://github.com/hugo-xie">WeiBo</a>
</div>
<div class="mainblog">
  <div class="blogsiderbar" id="content1">
       <div style="width: 100px;height: 100px;background-color: white;border-radius: 50px;background-image: url(/images/person.jpeg);background-size: 100% 100%"></div>
      <div style="color: white;font-size: 1.5em;font-weight: bold;">Hugo Xie</div>
      <div style="color: rgb(181,181,181);font-size: 1em;">Front End Developer</div>
  </div>
  <div class="phoneblogsiderbar" id="content1">
    <div style="width: 100px;height: 100px;background-color: white;border-radius: 50px;background-image: url(/images/person.jpeg);background-size: 100% 100%"></div>
    <div style="color: white;font-size: 1.5em;font-weight: bold;">Hugo Xie</div>
    <div style="color: rgb(181,181,181);font-size: 1em;">Front End Developer</div>
  </div>
  <div class="blogcontent" >
  <div style="width: 80%;margin-left: 10%;"id="content2">
    <h2>javascript中的task和microtask</h2>

<h3 style="color: green">先看一段代码</h3>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'1'</span><span class="p">);</span>
    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'2'</span><span class="p">);</span>
     <span class="p">},</span><span class="mi">0</span><span class="p">);</span>
    <span class="nx">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
       <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'3'</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"4"</span><span class="p">);</span></code></pre></figure>

<p>这个代码最终输出的结果是：</p>
<h3>1,4,3,2</h3>

<p>你答对了吗？这里有两个坑，第一个就是setTimeout()的第二个参数如果是0，那么其中的函数也不会立即执行，而是会放在下一轮的event loop里面。第二个坑就是javascript里的任务分为正常任务task和微任务microtask.</p>

<h4 style="color: lightblue">正常任务和微任务</h4>
<p>正常任务就是指那些不会在当前的event loop里面执行的任务，比如setTimeout()中的任务，不管它定义的执行时间是多久之后，它都是会被放在下一轮事件循环里执行的，但是微任务不一样，微任务是放在当前事件循环的末尾，也就是说在当前事件循环里的
任务都完成以后，就会去执行本轮事件循环末尾的微任务。</p>

<p>常见的回调任务都属于正常任务。</p>

<p>微任务当前只有以下两种</p>
<div style="border-left: 5px solid lightblue;color: light">
  <ul>
  <li>Promise</li>
  <li>nodejs中的process.nextTick</li>
</ul>
</div>


  </div>
  
  </div>
</div>
<script type="text/javascript">
  var content1 = document.getElementById('content1');
  var content2 = document.getElementById('content2');
  var content3 = document.getElementById('content3');
  var content3 = document.getElementById('content4');
  var height = window.innerHeight-90;
   var height2 = window.innerHeight-200;
   var height3 = window.innerHeight*0.38;
  content1.style.height = height+'px';
  content2.style.height = height+'px';
  content3.style.height = height2+'px';
  content4.style.height = height3+'px';
  console.log(main[0].style.height);
</script>
</body>
</html>